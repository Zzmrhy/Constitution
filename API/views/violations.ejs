<div>
    <h1 id="header3">Violations List</h1>
    <h2 id="pun">Total Violations: <%= totalBroken %></h2>
    <% if (violations && violations.length > 0) { %>
        <ul id="list">
            <% violations.forEach((violation, index) => { %>
                <li>
                    <% if (editingIndex === index) { %>
                        <form action="/violations/<%= index %>" method="POST">
                            <input type="hidden" name="_method" value="PUT">
                            <label>Date: <input type="date" name="date" value="<%= violation.date %>" required></label><br>
                            <label>Broken Rule:
                                <select name="brokenRules" required>
                                    <option value="">Select a rule</option>
                                    <% rules.forEach((rule) => { %>
                                        <option value="<%= rule %>" <%= violation.brokenRules.includes(rule) ? 'selected' : '' %>><%= rule %></option>
                                    <% }); %>
                                </select>
                            </label><br>
                            <button type="submit">Save</button>
                            <a href="/violations"><button type="button">Cancel</button></a>
                        </form>
                    <% } else { %>
                        <strong>Date:</strong> <%= violation.date %><br>
                        <strong>Broken Rule:</strong>
                        <% violation.brokenRules.forEach((rule) => { %>
                            <div><%= rule %></div>
                        <% }); %>
                        <% if (isAdmin) { %>
                            <a href="/violations?edit=<%= index %>"><button>Edit</button></a>
                        <% } %>
                    <% } %>
                </li>
            <% }); %>
        </ul>
    <% } else { %>
        <h1>No violations yet.</h1>
    <% } %>
</div>
